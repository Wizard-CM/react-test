import{d as q,e as v,j as a,f as c,R as S,s as i,S as y}from"./index-BTGMLHlo.js";import{u as I,B as $}from"./Button-DL5L6TLJ.js";function C({post:e}){var d,g,o,x,f;const{register:s,handleSubmit:b,setValue:N,getValues:h,formState:{errors:l}}=I({defaultValues:{title:(e==null?void 0:e.title)||"",slug:(e==null?void 0:e.$id)||"",content:(e==null?void 0:e.content)||"",status:(e==null?void 0:e.status)||"active"}}),u=q(),n=v(t=>t.auth.userData),w=async t=>{if(e){const r=t.image[0]?await i.uploadFile(t.image[0]):null;r&&i.deleteFile(e.featuredImage);const m=await i.updatePost({slug:e.$id,content:t.content,title:t.title,featuredImage:r?r.$id:e.featuredImage});m&&(u(`/post/${m.$id}`),console.log(m.$id))}else{const r=await i.uploadFile(t.image[0]);if(r){const m=r.$id;t.featuredImage=m;const j=await i.createPost({...t,userId:n.$id,userName:n.name});console.log(t),j&&u(`/post/${j.$id}`)}}};return a.jsxs("form",{onSubmit:b(w),className:"flex flex-wrap mt-5",children:[a.jsxs("div",{className:"w-full md:w-2/3 px-2",children:[a.jsx(c,{label:"Title :",placeholder:"Title",className:"",...s("title",{required:"Title is required"})}),l.title&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(d=l.title)==null?void 0:d.message}),a.jsx(c,{label:"Slug :",placeholder:"Slug",className:"",...s("slug",{required:"Slug is required"})}),l.slug&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(g=l.slug)==null?void 0:g.message}),a.jsx(S,{label:"Content :",defaultValue:h("content"),onChange:t=>{N("content",t)},...s("content",{required:"Content is required"})}),l.content&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(o=l.content)==null?void 0:o.message})]}),a.jsxs("div",{className:"w-full md:w-1/3 px-2 mt-5 md:mt-0",children:[a.jsx(c,{label:"Featured Image :",type:"file",className:"",accept:"image/png, image/jpg, image/jpeg, image/gif",...s("image",{required:"Image is required"})}),l.image&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(x=l.image)==null?void 0:x.message}),a.jsx(c,{label:"Category :",type:"text",className:"",placeholder:"category",...s("category",{required:"Category is required"})}),l.category&&a.jsx("p",{className:"text-red-600 text-[0.8rem] m-0 mb-4",role:"alert",children:(f=l.category)==null?void 0:f.message}),e&&a.jsx("div",{className:"w-full ",children:a.jsx("img",{src:i.getFilePreview(e.featuredImage),alt:e.title,className:"rounded-lg"})}),a.jsx(y,{options:["active","inactive"],label:"Status",className:"",...s("status",{required:!0})}),a.jsx($,{type:"submit",bgColor:e?"bg-green-500":void 0,className:"w-full",children:e?"Update":"Submit"})]})]})}export{C as P};
